
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>ec2ã«couchbaseã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ã¤ã„ã§ã«Python SDKã¨td-agentã‚‚ã€‚ - sgykfjsm.github.com</title>
  <meta name="author" content="sgykfjsm">

  
  <meta name="description" content="ç›®çš„ ec2ã«Couchbaseã‚’å…¥ã‚Œã‚‹ã¤ã„ã§ã«ã€fluentdã§é›†ã‚ãŸãƒ­ã‚°ã‚’couchbaseã«è²¯ã‚ã“ã‚€ã€‚ couchbaseã«ã¤ã„ã¦ å…ƒã€…ã¯Lutus Notesã‚’èµ·æºã«æŒã¤CouchDBã®é–‹ç™ºè€…ã®ã²ã¨ã‚Šã§ã‚ã‚‹Damien Katzæ°ãŒå•†æ¥­å±•é–‹ã—ã¦ã„ã‚‹è£½å“ã€‚ &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://sgykfjsm.github.io/blog/2013/08/18/couchbase-on-ec2-with-td-agent">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="sgykfjsm.github.com" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet" type="text/css">
<!--- MathJax Configuration -->
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-38784817-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">sgykfjsm.github.com</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscribe" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 13.310204,73.332654 C 5.967347,73.332654 0,79.322448 0,86.621428 c 0,7.338776 5.967347,13.262246 13.310204,13.262246 7.370408,0 13.328572,-5.92245 13.328572,-13.262246 0,-7.29898 -5.958164,-13.288774 -13.328572,-13.288774 z M 0.01530612,33.978572 V 53.143878 C 12.493878,53.143878 24.229592,58.02347 33.068368,66.865306 41.894898,75.685714 46.767346,87.47449 46.767346,100 h 19.25 C 66.017346,63.592858 36.4,33.979592 0.01530612,33.978572 l 0,0 z M 0.03877552,0 V 19.17449 C 44.54796,19.17551 80.77551,55.437756 80.77551,100 H 100 C 100,44.87653 55.15102,0 0.03877552,0 z"></path></svg></a></li>
  
</ul>
  
  
  
  
  
  
  
  
  
  
    
      <form action="http://google.com/search" method="get">
        <fieldset role="search">
          <input type="hidden" name="sitesearch" value="sgykfjsm.github.io" />
    
          <input class="search" type="text" name="q" results="0" placeholder="Search"/>
        </fieldset>
      </form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">ec2ã«couchbaseã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ã¤ã„ã§ã«Python SDKã¨td-agentã‚‚ã€‚</h1>
      
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2013-08-18T22:46:00+09:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:46 pm</span></time>
        
        
          
           | <a href="https://github.com/sgykfjsm/sgykfjsm.github.com/edit/master/source/_posts/2013-08-18-couchbase-on-ec2-with-td-agent.markdown">Edit</a>
          
        
      </p>
    
  </header>


<div class="entry-content"><a name="L......"></a>
<h2>ç›®çš„</h2>

<p>ec2ã«Couchbaseã‚’å…¥ã‚Œã‚‹ã¤ã„ã§ã«ã€fluentdã§é›†ã‚ãŸãƒ­ã‚°ã‚’couchbaseã«è²¯ã‚ã“ã‚€ã€‚</p>

<a name="couchbase............"></a>
<h2>couchbaseã«ã¤ã„ã¦</h2>

<ul>
<li>å…ƒã€…ã¯Lutus Notesã‚’èµ·æºã«æŒã¤<a href="http://couchdb.apache.org/">CouchDB</a>ã®é–‹ç™ºè€…ã®ã²ã¨ã‚Šã§ã‚ã‚‹Damien Katzæ°ãŒå•†æ¥­å±•é–‹ã—ã¦ã„ã‚‹è£½å“ã€‚</li>
<li>Memcachedã‚‚ãƒ™ãƒ¼ã‚¹ã¨ãªã£ã¦ã„ã‚‹ã®ã§ã€<a href="http://www.couchbase.com/jp/memcached">Memcachedã‚’Couchbaseã‚¯ãƒ©ã‚¹ã‚¿ã«ãƒªãƒ—ãƒ¬ãƒ¼ã‚¹ã—ãŸäº‹ä¾‹ã‚‚ã‚ã‚‹ã€‚</a></li>
<li>Enterprise Edition(EE)ã¨Community Edition(CE)ã®ï¼’ã¤ãŒã‚ã‚Šã€å‰è€…ã¯2nodeã¾ã§ç„¡æ–™ã€å¾Œè€…ã¯ç„¡åˆ¶é™ã«ç„¡æ–™ã§ä½¿ãˆã‚‹ã€‚</li>
<li>EEã¨CEã®é•ã„ã¯ã€EEã§ã¯ã‚µãƒãƒ¼ãƒˆãŒè³¼å…¥ã§ãã€CEã«æ¯”ã¹å…ˆé€²çš„ãªæ©Ÿèƒ½ãŒä»˜å±ã—ã¦ã„ã‚‹ã€‚å¯¾ã—ã¦CEã¯EEã®å‹è½ã¡ã®ã‚ˆã†ãªä½ç½®ã¥ã‘ã§ã‚ã‚‹ã€‚</li>
<li>MongoDBã¨åŒã˜ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‹NoSQLã«ä½ç½®ã¥ã‘ã‚‰ã‚Œã‚‹ã€‚</li>
<li>è‡ªå‹•ã‚·ãƒ£ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€åˆ†æ•£ã‚¯ã‚¨ãƒªã€ç‹¬ç«‹ã—ãŸã‚­ãƒ£ãƒƒã‚·ãƒ¥éƒ¡ãªã©ã®æ©Ÿèƒ½ã‚„ç‰¹å¾´ã‚’æŒã¤ã€‚</li>
</ul>


<!-- more -->


<a name="L......"></a>
<h2>å°å…¥</h2>

<p>ä»Šå›ã¯EC2ã®m1.smallã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãŒã€AWSã®<a href="http://aws.typepad.com/aws_japan/2013/08/running-couchbase-on-aws-new-white-paper.html">ãƒ›ãƒ¯ã‚¤ãƒˆãƒšãƒ¼ãƒ‘ãƒ¼</a>ã§ã¯æœ€å°ã§ã‚‚largeã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚ä»Šå›ã¯ãŠéŠã³ãªã®ã§ã€smallã¨ã™ã‚‹ãŒæœ¬ç•ªåˆ©ç”¨æ™‚ã«ã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ã‚¹ã‚±ãƒ¼ãƒ«ã¯é«˜ã‚ã«ã—ãŸã»ã†ãŒè‰¯ã•ãã†ã€‚</p>

<p>AWSã®market placeã«ã¯<a href="https://aws.amazon.com/marketplace/search/results/ref=gtw_navgno_search_box?searchTerms=couchbase&amp;search=">AMIãŒç”¨æ„</a>ã•ã‚Œã¦ãŠã‚Šã€ä¸€æ–¹ã§ã¯RightScaleã«ã‚ˆã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚‚ã‚ã‚‹ã€‚(<a href="http://www.couchbase.com/docs/couchbase-manual-2.1.0/couchbase-bestpractice-cloud.html">4.6. Using Couchbase in the Cloud</a>)</p>

<p>ã“ã®ã‚ˆã†ã«æ‰‹è»½ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹æ–¹æ³•ã¯ã„ãã¤ã‹ã®æ–¹æ³•ãŒã‚ã‚‹ãŒã€ä»Šå›ã¯å­¦ç¿’ã®ãŸã‚RPMã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œã†ã€‚</p>

<p>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ã¯ä»¥ä¸‹ã®URLã§ã‚ã‚‹ã€‚<br>
<a href="http://www.couchbase.com/jp/download">http://www.couchbase.com/jp/download</a></p>

<p>ã“ã‚Œä»¥é™ã®ä½œæ¥­ã¯ç”¨æ„ã—ãŸEC2ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦è¡Œã†ã€‚</p>

<a name="L............"></a>
<h3>äº‹å‰æº–å‚™</h3>

<p>ã“ã‚Œã¯ã¨ã¦ã‚‚é‡è¦ãªã®ã ã‘ã©ã€ç«‹ã¡ä¸Šã’ãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã¯ElasticIPã‚’æŒ¯ã£ã¦ãŠãã“ã¨ã€‚ã§ãªã„ã¨ã€SDKã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒå‡ºæ¥ãªã„ã€‚
ãªãœãã†ãªã®ã‹ã¯ã¾ã ç†ç”±ãŒã¤ã‹ã‚ã¦ã„ãªã„ã€‚
ã¾ãŸã€ã‚‚ã—Couchbase Serverã®nodeåãŒPrivate IPsã«ãªã£ã¦ã„ãŸã‚‰ã€ä»¥ä¸‹ã®æ‰‹é †ã«ã—ãŸãŒã£ã¦nodeåã‚’å¤‰æ›´ã—ã¦ãŠãå¿…è¦ãŒã‚ã‚‹ã€‚</p>

<ul>
<li><a href="http://www.couchbase.com/docs/couchbase-manual-2.0/couchbase-getting-started-hostnames-pre2.0.html">2.4.1. Hostnames for Couchbase Server 2.0.1 and Earlier</a></li>
</ul>


<p>ã“ã®è¨­å®šã‚’ã—ã¦ãªã„ã¨ã¨ã¦ã‚‚å¤§å¤‰ãªã“ã¨ã«ãªã‚‹ã€‚</p>

<a name="OpenSSL............"></a>
<h3>OpenSSLã‚’å…¥ã‚Œã‚‹</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[ec2-user@ip-xx-xxx-xx-xxx tmp]$ sudo yum install -y openssl098e
</span><span class='line'>Loaded plugins: priorities, security, update-motd, upgrade-helper
</span><span class='line'>amzn-main                                                                                                        | 2.1 kB     00:00
</span><span class='line'># çœç•¥
</span><span class='line'>Installed:
</span><span class='line'>  openssl098e.x86_64 0:0.9.8e-17.8.amzn1
</span><span class='line'>
</span><span class='line'>Complete!</span></code></pre></td></tr></table></div></figure>


<a name="couchbase.server.2.0.1............"></a>
<h3>couchbase server 2.0.1ã‚’å…¥ã‚Œã‚‹</h3>

<p>å–å¾—å…ƒã®URLã¯<a href="http://www.couchbase.com/jp/download">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸</a>ã‹ã‚‰ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[ec2-user@ip-xx-xxx-xx-xxx tmp]$ wget http://packages.couchbase.com/releases/2.0.1/couchbase-server-community_x86_64_2.0.1.rpm
</span><span class='line'>--2013-08-11 08:47:37--  http://packages.couchbase.com/releases/2.0.1/couchbase-server-community_x86_64_2.0.1.rpm
</span><span class='line'># çœç•¥
</span><span class='line'>2013-08-11 08:49:00 (1.47 MB/s) - `couchbase-server-community_x86_64_2.0.1.rpm' ã¸ä¿å­˜å®Œäº† [126631806/126631806]
</span><span class='line'>[ec2-user@ip-xx-xxx-xx-xxx tmp]$ sudo rpm -ivh couchbase-server-community_x86_64_2.0.1.rpm
</span><span class='line'>æº–å‚™ä¸­...                ########################################### [100%]
</span><span class='line'>Minimum RAM required  : 4 GB
</span><span class='line'>System RAM configured : 1696704 kB
</span><span class='line'>
</span><span class='line'>Minimum number of processors required : 4 cores
</span><span class='line'>Number of processors on the system    : 1 cores
</span><span class='line'>
</span><span class='line'>   1:couchbase-server       ########################################### [100%]
</span><span class='line'>Starting couchbase-server[  OK  ]
</span><span class='line'>
</span><span class='line'>You have successfully installed Couchbase Server.
</span><span class='line'>Please browse to http://ip-xx-xxx-xx-xxx:8091/ to configure your server.
</span><span class='line'>Please refer to http://couchbase.com for additional resources.
</span><span class='line'>
</span><span class='line'>Please note that you have to update your firewall configuration to
</span><span class='line'>allow connections to the following ports: 11211, 11210, 11209, 4369,
</span><span class='line'>8091, 8092 and from 21100 to 21299.
</span><span class='line'>
</span><span class='line'>By using this software you agree to the End User License Agreement.
</span><span class='line'>See /opt/couchbase/LICENSE.txt.</span></code></pre></td></tr></table></div></figure>


<p>ãƒ­ã‚°ã«ä»¥ä¸‹ã®ã‚ˆã†ã«å‡ºã¦ã„ã‚‹ã‘ã©ã€å…¨ãè¶³ã‚Šã¦ãªã„â€¦ã€ãŒã€ä»Šå›ã¯å­¦ç¿’ã®ãŸã‚ãªã®ã§æ°—ã«ã—ãªã„ã€‚ãªãŠã€ã‚³ãƒ¬ã‚’æº€ãŸã™ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯largeã¾ãŸã¯xlargeã‹ã‚‰ãªã®ã§ã€NoSQLç³»ã¯ã‚„ã¯ã‚Šãªã‚“ã ã‹ã‚“ã è¨€ã£ã¦ãŠé‡‘ãŒç„¡ã„ã¨ãƒ€ãƒ¡ãªã®ã§ã‚ã‚‹ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Minimum RAM required  : 4 GB
</span><span class='line'>System RAM configured : 1696704 kB
</span><span class='line'>
</span><span class='line'>Minimum number of processors required : 4 cores
</span><span class='line'>Number of processors on the system    : 1 cores</span></code></pre></td></tr></table></div></figure>


<p>ã‚ã¨ã¯æŒ‡å®šã•ã‚ŒãŸURL:<a href="http://ip-xx-xxx-xx-xxx:8091/%E3%81%AB%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%97%E3%81%A6GUI%E3%81%AE%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%81%AB%E5%BE%93%E3%81%A3%E3%81%A6%E3%81%84%E3%81%91%E3%81%B0%E5%B0%8E%E5%85%A5%E3%81%AF%E7%B5%82%E4%BA%86%E3%80%82%E7%B0%A1%E5%8D%98%E3%81%A7%E3%81%82%E3%82%8B%E3%80%82">http://ip-xx-xxx-xx-xxx:8091/%E3%81%AB%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%97%E3%81%A6GUI%E3%81%AE%E3%82%A6%E3%82%A3%E3%82%B6%E3%83%BC%E3%83%89%E3%81%AB%E5%BE%93%E3%81%A3%E3%81%A6%E3%81%84%E3%81%91%E3%81%B0%E5%B0%8E%E5%85%A5%E3%81%AF%E7%B5%82%E4%BA%86%E3%80%82%E7%B0%A1%E5%8D%98%E3%81%A7%E3%81%82%E3%82%8B%E3%80%82</a></p>

<a name="CRUD"></a>
<h2>CRUD</h2>

<p>Couchbaseã¯REST APIã‚’å‚™ãˆã¦ã„ã‚‹ãŒã€ç”¨é€”ã¨ã—ã¦ã¯ãƒãƒ¼ãƒ‰ã‚„ã‚¯ãƒ©ã‚¹ã‚¿ã®ç®¡ç†ã«åˆ©ç”¨ã™ã‚‹ã®ãŒæ­£ã—ã„ã£ã½ã„ã€‚<br>
å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æœ‰ã‚‹ã€‚</p>

<blockquote><p>REST APIã¯ã‚µãƒ¼ãƒã¸ã®ãƒ‡ãƒ¼ã‚¿èª­ã¿æ›¸ãã«åˆ©ç”¨ã™ã‚‹ã¹ãã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
ãŸã¨ãˆã°ã€setã‚„getãªã©ã®ãƒ‡ãƒ¼ã‚¿æ“ä½œã¯Couchbase SDKã«ã‚ˆã£ã¦å‡¦ç†ã—ã¾ã™ã€‚
Couchbase SDKã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚</p></blockquote>

<p>ã¨ã„ã†ã‚ã‘ã§ã€CRUDã‚’è©¦ã™ãŸã‚ã«ã¯SDKãŒå¿…è¦ã§ã‚ã‚‹ã€‚</p>

<a name="Python.SDK"></a>
<h2>Python SDK</h2>

<p>ä»Šå›ã¯ã‚µã‚¯ãƒƒã¨ã‚„ã‚ŠãŸã„ã®ã§Python SDKã‚’ä½¿ã†ã€‚Python SDKã¯Couchbaseã®C SDKã‚’ä½¿ã£ã¦ä½œã‚‰ã‚Œã¦ã„ã‚‹ã®ã§ã€ã¾ãš C SDKã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚<br>
ã¡ãªã¿ã«å…¬å¼ã®<a href="http://www.couchbase.com/communities/python/getting-started">Getting Start</a>ã«å¾“ã£ãŸã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[sgyk@fujishima]
</span><span class='line'>$ brew install libcouchbase
</span><span class='line'>==&gt; Downloading http://packages.couchbase.com/clients/c/libcouchbase-2.0.7.tar.gz
</span><span class='line'>######################################################################## 100.0%
</span><span class='line'>==&gt; ./configure --prefix=/usr/local/Cellar/libcouchbase/2.0.7 --disable-examples --disable-tests --disable-couchbasemock
</span><span class='line'>==&gt; make install
</span><span class='line'>ğŸº  /usr/local/Cellar/libcouchbase/2.0.7: 106 files, 964K, built in 28 seconds</span></code></pre></td></tr></table></div></figure>


<p>Pythonã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯2.6ä»¥ä¸Šã§ã‚ã‚‹ã“ã¨ãŒå¿…è¦ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[sgyk@fujishima]
</span><span class='line'>$ python -V
</span><span class='line'>Python 2.7.3</span></code></pre></td></tr></table></div></figure>


<p>æ¬¡ã«<code>pip</code>ã§SDKã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãŒã€Xcodeã®CLI Toolsã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãªã„ã¨ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦æ‚²ã—ã„æ°—æŒã¡ã«ãªã‚‹ã®ã§ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãªã‘ã‚Œã°äºˆã‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãã“ã¨ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>unable to execute /usr/bin/clang: No such file or directory</span></code></pre></td></tr></table></div></figure>


<p>Python SDKã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[sgyk@fujishima]
</span><span class='line'>$ pip install couchbase
</span><span class='line'>Downloading/unpacking couchbase
</span><span class='line'>  Running setup.py egg_info for package couchbase
</span><span class='line'># çœç•¥
</span><span class='line'>Successfully installed couchbase
</span><span class='line'>Cleaning up...</span></code></pre></td></tr></table></div></figure>


<p>ã¡ã‚ƒã‚“ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããŸã‹ã‚’ç¢ºèªã™ã‚‹ã€‚</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[sgyk@fujishima]
</span><span class='line'>$ python
</span><span class='line'>Python 2.7.3 (default, Nov  9 2012, 22:02:35)
</span><span class='line'>[GCC 4.2.1 Compatible Apple Clang 4.0 ((tags/Apple/clang-421.0.60))] on darwin
</span><span class='line'>Type "help", "copyright", "credits" or "license" for more information.
</span><span class='line'>&gt;&gt;&gt; from couchbase import Couchbase
</span><span class='line'>&gt;&gt;&gt;</span></code></pre></td></tr></table></div></figure>


<p>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãªã‘ã‚Œã°OK</p>

<p>ãªã‚“ã‹æ°—ã®åˆ©ã„ãŸã‚„ã¤ã‚’æ›¸ã“ã†ã‹ã¨æ€ã£ãŸã‘ã©ã€<a href="https://github.com/couchbase/couchbase-python-client#using">githubã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰</a>ã‚’ã¨ã‚Šã‚ãˆãšè©¦ã—ã¦ã¿ã‚‹ã®ãŒè‰¯ã•ãã†ã€‚<br>
ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ãŸã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€éå¸¸ã«å°‘ãªã„ã‚¹ãƒ†ãƒƒãƒ—ã§ãƒ‡ãƒ¼ã‚¿æ“ä½œãŒã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã¨æ€ã†ã€‚<br>
ã‚ã¨ã¯<a href="http://pythonhosted.org/couchbase/">APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>ã‚’ã•ã‚‰ã£ã¨è¦‹ã¦ãŠã‘ã°ã¨ã‚Šã‚ãˆãšã®ã“ã¨ã¯ã§ããã†ã§ã¯ã‚ã‚‹ã€‚</p>

<a name="Fluentd............"></a>
<h2>Fluentdã¨ã®é€£æº</h2>

<p>æ­£ç›´ã€ã‚ã‚“ã¾ã‚Šæ›¸ãã¹ãã“ã¨ã¯ãªã‹ã£ãŸã‚Šã™ã‚‹ã€‚ã¨ã„ã†ã®ã‚‚ã€ã™ã§ã«<a href="https://github.com/obieq/fluent-plugin-couchbase#">ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹</a>ãŸã‚ã€ãã‚Œã‚’ä½¿ãˆã°ã‚ã£ã¨ã„ã†é–“ã«ã§ãã‚‹ã€‚å°‘ã—ãƒãƒã£ãŸã¨ã“ã‚ã¯ã€æ›¸ãè¾¼ã¿ã®ç®‡æ‰€ãŒ</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># https://github.com/obieq/fluent-plugin-couchbase/blob/master/lib/fluent/plugin/out_couchbase.rb#L52</span>
</span><span class='line'><span class="n">connection</span><span class="o">[</span><span class="n">record</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">),</span>  <span class="ss">:ttl</span> <span class="o">=&gt;</span> <span class="nb">self</span><span class="o">.</span><span class="n">ttl</span><span class="o">]</span> <span class="o">=</span> <span class="n">record</span>
</span></code></pre></td></tr></table></div></figure>


<p>ã¨ãªã£ã¦ã„ã‚‹ãŸã‚ã€ãƒ­ã‚°ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ä¸­ã«keyã¨ã„ã†è¦ç´ ï¼ˆrubyã§ã„ã†ã¨ã“ã‚ã®ã‚¨ãƒ³ãƒˆãƒªï¼Ÿï¼‰ãŒå¿…è¦ã«ãªã‚‹ã€‚ã“ã‚ŒãŒç„¡ã„ã¨ã€couchbaseã«æ›¸ãè¾¼ã‚€éš›ã«ãƒ­ã‚°ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒ<code>nil</code>ã¨ãªã£ã¦ã—ã¾ã„ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã€‚<br>
ãã‚Œä»¥å¤–ã¯td-agentã¨ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã€couchbaseãŒã‚ˆã‚ã—ãã‚„ã£ã¦ãã‚Œã‚‹ãŸã‚éå¸¸ã«æ¥½ã«æ ¼ç´ã§ãã‚‹ã€‚</p>

<p>ã¾ãŸã€couchbaseã¯ãƒã‚±ãƒƒãƒˆã”ã¨ã«èªè¨¼ã‚’è¨­ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ãŒã€ä¸Šã§ç´¹ä»‹ã—ãŸãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ãƒã‚±ãƒƒãƒˆèªè¨¼ã«å¯¾å¿œã—ã¦ã„ãªã„ã€‚<br>
ã“ã‚Œã«å¯¾å¿œã—ã¦ã„ã‚‹ã®ã¯<a href="https://github.com/atware/fluent-plugin-couchbase">atware/fluent-plugin-couchbase</a>ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã‚ã‚‹ã€‚ã¡ãªã¿ã«<a href="http://www.atware.co.jp/">æ ªå¼ä¼šç¤¾ ã‚¢ãƒƒãƒˆã‚¦ã‚§ã‚¢</a>ã¨ã„ã†ä¼šç¤¾ã¯å¤šåˆ†ã€ä»Šã®ã¨ã“ã‚ã€æ—¥æœ¬ã§ä¸€ç•ªCouchbaseã«ç²¾é€šã—ã¦ã„ã‚‹ä¼šç¤¾ã‹ã‚‚ã—ã‚Œãªã„ã€‚</p>

<a name="L......"></a>
<h2>ä»Šå¾Œ</h2>

<p>Couchbaseã®å°å…¥ã‹ã‚‰td-agentã®é€£æºã¾ã§ã®ä½œæ¥­ã¯æ…£ã‚ŒãŸã‚‰å¤šåˆ†1æ™‚é–“ã‹ã‹ã‚‰ãªã„ã€‚<br>å•é¡Œã¯ã‚€ã—ã‚ã“ã®å¾Œã«ã‚ã£ã¦ã€Couchbaseã§ã¯RDBã§ã„ã†ã¨ã“ã‚ã®SQLã®ã‚ˆã†ãªDMLã¯Viewã¨å‘¼ã°ã‚Œã‚‹Javascriptã®MapReduceã§è¨˜è¿°ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãªã®ã§ã€ãƒ­ã‚°ã®é‹ç”¨ã‚’Couchbaseã«åˆ‡ã‚Šæ›¿ãˆã‚‹å ´åˆã¯ã€å¦‚ä½•ã«ã—ã¦ã“ã‚Œã¾ã§RDBã§å‹•ã‹ã—ã¦ããŸSQLã‚’ç§»è¡Œã™ã‚‹ã‹ãŒå¤§ããªå•é¡Œã¨ãªã‚‹ã€‚SQLãƒãƒªãƒãƒªã®ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒJavascriptã‚’åŒã˜ç¨‹åº¦æ›¸ã‘ã‚‹ã‹ã¨è¨€ã‚ã‚Œã‚‹ã¨å¤šãã¯ãã†ã§ãªã„ã¨æ€ã†ã®ã§ã€‚ã¾ãã“ã‚Œã¯NoSQLç³»DBã‚’é‹ç”¨ã™ã‚‹ã¨ãã®å®¿å‘½ãªã®ã§ä»Šæ›´ã„ã†ã“ã¨ã§ã‚‚ç„¡ã„ã‹ã€‚</p>

<p>Couchbaseã®Viewã«ã¤ã„ã¦ã¯ã¾ãŸè‰²ã€…èª¿ã¹ã¦ã€ãƒ–ãƒ­ã‚°ã«ã¾ã¨ã‚ã‚ˆã†ã‹ãªã€‚</p>

<a name="L......"></a>
<h2>å‚è€ƒ</h2>

<ul>
<li><a href="http://www.atware.co.jp/2013/07/25/fluentd-couchbase-log-analysis/">Fluentd + Couchbase ã«ã‚ˆã‚‹ãƒ­ã‚°è§£æå°å…¥äº‹ä¾‹</a></li>
<li><a href="http://www.atmarkit.co.jp/fdb/rensai/dbwatch2012/dbwatch201202_02.html">ã©ã£ã¡ãŒé¢ç™½ã„ï¼Ÿ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæŒ‡å‘ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</a></li>
<li><a href="http://pythonhosted.org/couchbase/">Couchbase Python Client Library Documentation</a></li>
<li><a href="https://github.com/obieq/fluent-plugin-couchbase">obieq/fluent-plugin-couchbase</a></li>
<li><a href="http://aws.typepad.com/aws/2013/08/running-couchbase-on-aws-new-white-paper.html">Running Couchbase on AWS - New White Paper</a></li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  



  <span class="byline author vcard">Authored by <span class="fn">
  
    sgykfjsm
  
  </span></span>


      




<time class='entry-date' datetime='2013-08-18T22:46:00+09:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2013</span></span> <span class='time'>10:46 pm</span></time>
      <span class="categories">full history <a href="https://github.com/sgykfjsm/sgykfjsm.github.com/commit/master/source/_posts/2013-08-18-couchbase-on-ec2-with-td-agent.markdown">here</a></span>

      

<span class="categories">
  
    <a class='category' href='/blog/categories/couchbase/'>couchbase</a>, <a class='category' href='/blog/categories/ec2/'>ec2</a>, <a class='category' href='/blog/categories/fluentd/'>fluentd</a>, <a class='category' href='/blog/categories/pytohn/'>pytohn</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/08/11/fluentd-on-ec2-with-s3/" title="Previous Post: ec2ã«fluentdã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹">&laquo; ec2ã«fluentdã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹</a>
      
      
        <a class="basic-alignment right" href="/blog/2013/08/31/elasticemapreduce-with-dynamodb/" title="Next Post: DynamoDBã‚’EMRã§æ‰±ã†ã¨ãã«æ°—ã‚’ã¤ã‘ã‚‹ã“ã¨">DynamoDBã‚’EMRã§æ‰±ã†ã¨ãã«æ°—ã‚’ã¤ã‘ã‚‹ã“ã¨ &raquo;</a>
      
    </p>
  </footer>
</article>


</div>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - sgykfjsm -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | Themed with <a href="https://github.com/lucaslew/whitespace">Whitespace</a></span>
</p>

</footer>
  














</body>
</html>
